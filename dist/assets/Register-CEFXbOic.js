import{P as A}from"./PasspointCollector-C-mlmq2K.js";import{k as L}from"./driver-nEzLYb3z.js";import{l as k,p as P,d as l,q as U,o as w,c as S,b as a,g as u,w as h,u as q,z as D,t as $,a as R,v as N,A as H,x as B,y as M}from"./index-BayGUjSY.js";const _={class:"grid grid-cols-1 md:grid-cols-2 lg:w-3/5"},Z={id:"step1",class:"flex flex-col gap-6 py-6 px-3 items-center md:start-start"},Y={class:"flex flex-col"},j={id:"step2",class:"flex items-center gap-2"},G={class:"flex flex-col"},J={key:0,class:"text-red-400 text-xs"},K={id:"step3",class:"w-full flex flex-col gap-2"},O={id:""},te=k({__name:"Register",setup(Q){const C=P(),V=M(),v=l(null),p=l(null),d=l(""),c=l(!1),g=l(!1),m=l(null),r=l(null),f=l(""),x=l(!1),b=n=>{C.add({severity:"error",summary:"Info",detail:n,life:3e3})},F=U(()=>{var e,t,o,i,s,T,y;const n=/^[-\w.%+]{1,64}@(?:[A-Z0-9-]{1,63}\.){1,125}[A-Z]{2,63}$/i;return g.value?((e=m.value)==null?void 0:e.points.length)!=((t=r.value)==null?void 0:t.points.length)?d.value="Las contraseñas deben ser iguales":((o=r.value)==null?void 0:o.points.length)!=5&&((i=r.value)==null?void 0:i.points.length)!=5?d.value="La contraseña debe ser de 5 caracteres":n.test(p.value??"")?d.value="":d.value="utilice un correo válido":d.value="Debe aceptar compartir sus datos",g.value&&((s=m.value)==null?void 0:s.points.length)==((T=r.value)==null?void 0:T.points.length)&&((y=r.value)==null?void 0:y.points.length)==5&&v.value&&p.value&&n.test(p.value??"")});async function I(){var e,t;if(((e=m.value)==null?void 0:e.image.name)!=((t=r.value)==null?void 0:t.image.name)){b("Por favor use una sola imagen");return}if(!v.value||!p.value){b("Rellene todos los campos");return}const n={username:v.value,email:p.value,password:m.value,passwordConfirmation:r.value};x.value=!0;try{const{data:o,error:i}=await N().register(n);o&&!o.success?b(z(o.message)):(H.auth.setSession(o.session),V.push({name:"user-info"}))}catch(o){console.log(o)}x.value=!1}function z(n){if(n=="Error al registrar en Supabase Auth: A user with this email address has already been registered")return"Ya hay una cuenta para este usuario";if(n=="Passwords dont Match")return"Las Contraseñas deben coincidir"}localStorage.getItem("register_tutorail")==null&&(E(),localStorage.setItem("register_tutorail","checked"));function E(){L({showProgress:!0,smoothScroll:!0,animate:!0,steps:[{popover:{title:"Bienvenido",description:"Este es el registro de su contraseña basada en Passpoints",position:"center",nextBtnText:"Siguiente",prevBtnText:"Anterior",doneBtnText:"Finalizar"}},{element:"#step1",popover:{title:"Informaciòn de Usuario",description:"Debe introducir su informaciòn de identificaciòn",position:"bottom",nextBtnText:"Siguiente",prevBtnText:"Anterior",doneBtnText:"Finalizar"}},{element:"#step2",popover:{title:"Aceptar compartir sus datos",description:"Al usar este servicio estrà cediendo su contraseña para un estudio acadèmico sobre este sistema, no es recomendable guardar informaciòn sensible",position:"right",nextBtnText:"Siguiente",prevBtnText:"Anterior",doneBtnText:"Finalizar"}},{element:"#step3",popover:{title:"Contraseña",description:"Aquì deberà insertar y confirmar su contraseña",position:"top",nextBtnText:"Siguiente",prevBtnText:"Anterior",doneBtnText:"Finalizar"}},{element:"#passpoint1",popover:{title:"Introducir una contraseña",description:"Aquì deberà insertar y confirmar su contraseña,esta consistirà en una selecciòn de 5 puntos donde el orden de estos importa",position:"top",nextBtnText:"Siguiente",prevBtnText:"Anterior",doneBtnText:"Finalizar"}},{element:"#passpoint1 .image-selector",popover:{title:"Cambiar imagen",description:"Aqui puede cambiar la imagen para su contraseña, basta con navegar y dar click en la imagen que desee",position:"top",nextBtnText:"Siguiente",prevBtnText:"Anterior",doneBtnText:"Finalizar"}},{element:"#passpoint1 .image-change",popover:{title:"selector de imagen",description:"Activa el selector de imagen en caso de querer cambiarla",position:"top",nextBtnText:"Siguiente",prevBtnText:"Anterior",doneBtnText:"Finalizar"},onHighlightStarted:(t,o,i)=>{console.log(t.style,t.dispatchEvent),t.classList.remove("ui")},onDeselected:(t,o,i)=>{console.log(t.style,t.dispatchEvent),t.classList.add("ui")}},{element:"#passpoint1 .toggle-show",popover:{title:"Ver puntos",description:"En esta opcion puede hacer que se muestren/oculten los puntos seleccionados",position:"top",nextBtnText:"Siguiente",prevBtnText:"Anterior",doneBtnText:"Finalizar"},onHighlightStarted:(t,o,i)=>{console.log(t.style,t.dispatchEvent),t.classList.remove("ui")},onDeselected:(t,o,i)=>{console.log(t.style,t.dispatchEvent),t.classList.add("ui")}},{element:"#passpoint1 .toggle-fullscreen",popover:{title:"Pantalla completa",description:"Ponga el selector a pantalla completa",position:"top",nextBtnText:"Siguiente",prevBtnText:"Anterior",doneBtnText:"Finalizar"},onHighlightStarted:(t,o,i)=>{console.log(t.style,t.dispatchEvent),t.classList.remove("ui")},onDeselected:(t,o,i)=>{console.log(t.style,t.dispatchEvent),t.classList.add("ui")}}]}).drive()}return(n,e)=>{const t=B("Input"),o=B("FloatLabel"),i=B("Button");return w(),S("div",_,[a("div",Z,[u(o,{class:"w-full"},{default:h(()=>[e[12]||(e[12]=a("label",{for:"name"},"Usuario",-1)),u(t,{onInput:e[0]||(e[0]=s=>c.value=!0),id:"name",class:"w-full",modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=s=>v.value=s)},null,8,["modelValue"])]),_:1}),u(o,{class:"w-full"},{default:h(()=>[e[13]||(e[13]=a("label",{for:"mail"},"Correo",-1)),u(t,{onInput:e[2]||(e[2]=s=>c.value=!0),id:"mail",type:"email",class:"w-full",modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=s=>p.value=s)},null,8,["modelValue"])]),_:1}),a("div",Y,[a("div",j,[u(q(D),{modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=s=>g.value=s),inputId:"share",binary:"",onInput:e[5]||(e[5]=s=>c.value=!0)},null,8,["modelValue"]),e[14]||(e[14]=a("label",{for:"share"}," Compartir mis datos ",-1))]),e[15]||(e[15]=a("small",{class:"text-zinc-400"},"al aceptar sus datos como contraseñas seràn empleados para llevar a cabo un estudio de seguridad sobre este sistema",-1))]),a("div",G,[u(i,{type:"button",disabled:!F.value,label:"Registrar",loading:x.value,onClick:I},null,8,["disabled","loading"]),c.value?(w(),S("small",J,$(d.value),1)):R("",!0)])]),a("div",K,[a("div",O,[e[16]||(e[16]=a("label",{for:"passpoints1"},"Passpoints",-1)),u(A,{onClick:e[6]||(e[6]=s=>c.value=!0),id:"passpoint1","onUpdate:image":e[7]||(e[7]=s=>f.value=s),image:f.value,"onUpdate:passpoints":e[8]||(e[8]=s=>m.value=s)},null,8,["image"])]),a("div",null,[e[17]||(e[17]=a("label",{for:"passpoints2"},"Confirmar Passpoints",-1)),u(A,{id:"passpoint2",onClick:e[9]||(e[9]=s=>c.value=!0),image:f.value,"onUpdate:passpoints":e[10]||(e[10]=s=>r.value=s),"onUpdate:image":e[11]||(e[11]=s=>f.value=s)},null,8,["image"])])])])}}});export{te as default};
