import{P as w,s as x}from"./supabase-CTLQoQ3I.js";import{d as I,u as k,r,a as N,o as R,c as E,b as a,e as n,w as y,h as F,f as c,g as L,s as M}from"./index-6ub7yXZy.js";import"./_commonjsHelpers-C4iS2aBk.js";const _={class:"grid grid-cols-1 md:grid-cols-2 lg:w-3/5"},A={class:"flex flex-col gap-6 py-6 px-3 items-center md:start-start"},S={class:"flex flex-col"},q={class:"flex items-center gap-2"},z={class:"w-full flex flex-col gap-2"},G=I({__name:"Register",setup(T){const V=k(),C=L(),u=r(null),i=r(null),f=r(!1),p=r(null),d=r(null),m=r(""),v=r(!1),g=l=>{V.add({severity:"error",summary:"Info",detail:l,life:3e3})},U=N(()=>{var l,e,t;return f.value&&((l=p.value)==null?void 0:l.points.length)==((e=d.value)==null?void 0:e.points.length)&&((t=d.value)==null?void 0:t.points.length)==5&&!(!u.value||!i.value)});async function P(){var e,t;if(((e=p.value)==null?void 0:e.image.name)!=((t=d.value)==null?void 0:t.image.name)){g("Por favor use una sola imagen");return}if(!u.value||!i.value){g("Rellene todos los campos");return}const l={username:u.value,email:i.value,password:p.value,passwordConfirmation:d.value};v.value=!0;try{const{data:o,error:b}=await x.functions.invoke("passpoints-register",{body:l});o&&!o.success?g(B(o.message)):(x.auth.setSession(o.session),C.push({name:"notes"}))}catch(o){console.log(o)}v.value=!1}function B(l){if(l=="Error al registrar en Supabase Auth: A user with this email address has already been registered")return"Ya hay una cuenta para este usuario";if(l=="Passwords dont Match")return"Las Contraseñas deben coincidir"}return(l,e)=>{const t=c("Input"),o=c("FloatLabel"),b=c("Button");return R(),E("div",_,[a("div",A,[n(o,{class:"w-full"},{default:y(()=>[e[7]||(e[7]=a("label",{for:"name"},"Name",-1)),n(t,{id:"name",class:"w-full",modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s)},null,8,["modelValue"])]),_:1}),n(o,{class:"w-full"},{default:y(()=>[e[8]||(e[8]=a("label",{for:"mail"},"Mail",-1)),n(t,{id:"mail",type:"email",class:"w-full",modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=s=>i.value=s)},null,8,["modelValue"])]),_:1}),a("div",S,[a("div",q,[n(F(M),{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=s=>f.value=s),inputId:"share",id:"share",binary:""},null,8,["modelValue"]),e[9]||(e[9]=a("label",{for:"share"}," Compartir mis datos ",-1))]),e[10]||(e[10]=a("small",{class:"text-zinc-400"},"al aceptar sus datos como contraseñas seràn empleados para llevar a cabo un estudio de seguridad sobre este sistema",-1))]),n(b,{type:"button",disabled:!U.value,label:"Registrar",loading:v.value,onClick:P},null,8,["disabled","loading"])]),a("div",z,[a("div",null,[e[11]||(e[11]=a("label",{for:"passpoints1"},"Passpoints",-1)),n(w,{id:"passpoint1","onUpdate:image":e[3]||(e[3]=s=>m.value=s),image:m.value,"onUpdate:passpoints":e[4]||(e[4]=s=>p.value=s)},null,8,["image"])]),a("div",null,[e[12]||(e[12]=a("label",{for:"passpoints2"},"Confirmar Passpoints",-1)),n(w,{id:"passpoint2",image:m.value,"onUpdate:passpoints":e[5]||(e[5]=s=>d.value=s),"onUpdate:image":e[6]||(e[6]=s=>m.value=s)},null,8,["image"])])])])}}});export{G as default};
